TFile (TUnit (TRevision "0.9.5") (TLanguage "C") (TFileName "src.c")) [MTChild (TCommentChild (TCommentText "/* ssl/d1_both.c */")),MTChild (TCommentChild (TCommentText "/* \n * DTLS implementation written by Nagendra Modadugu\n * (nagendra@cs.stanford.edu) for the OpenSSL project 2005.  \n */")),MTChild (TCommentChild (TCommentText "/* ====================================================================\n * Copyright (c) 1998-2005 The OpenSSL Project.  All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n *\n * 1. Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer. \n *\n * 2. Redistributions in binary form must reproduce the above copyright\n *    notice, this list of conditions and the following disclaimer in\n *    the documentation and/or other materials provided with the\n *    distribution.\n *\n * 3. All advertising materials mentioning features or use of this\n *    software must display the following acknowledgment:\n *    \\\"This product includes software developed by the OpenSSL Project\n *    for use in the OpenSSL Toolkit. (http://www.openssl.org/)\\\"\n *\n * 4. The names \\\"OpenSSL Toolkit\\\" and \\\"OpenSSL Project\\\" must not be used to\n *    endorse or promote products derived from this software without\n *    prior written permission. For written permission, please contact\n *    openssl-core@openssl.org.\n *\n * 5. Products derived from this software may not be called \\\"OpenSSL\\\"\n *    nor may \\\"OpenSSL\\\" appear in their names without prior written\n *    permission of the OpenSSL Project.\n *\n * 6. Redistributions of any form whatsoever must retain the following\n *    acknowledgment:\n *    \\\"This product includes software developed by the OpenSSL Project\n *    for use in the OpenSSL Toolkit (http://www.openssl.org/)\\\"\n *\n * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'\\' AND ANY\n * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR\n * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,\n * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED\n * OF THE POSSIBILITY OF SUCH DAMAGE.\n * ====================================================================\n *\n * This product includes cryptographic software written by Eric Young\n * (eay@cryptsoft.com).  This product includes software written by Tim\n * Hudson (tjh@cryptsoft.com).\n *\n */")),MTChild (TCommentChild (TCommentText "/* Copyright (C) 1995-1998 Eric Young (eay@cryptsoft.com)\n * All rights reserved.\n *\n * This package is an SSL implementation written\n * by Eric Young (eay@cryptsoft.com).\n * The implementation was written so as to conform with Netscapes SSL.\n * \n * This library is free for commercial and non-commercial use as long as\n * the following conditions are aheared to.  The following conditions\n * apply to all code found in this distribution, be it the RC4, RSA,\n * lhash, DES, etc., code; not just the SSL code.  The SSL documentation\n * included with this distribution is covered by the same copyright terms\n * except that the holder is Tim Hudson (tjh@cryptsoft.com).\n * \n * Copyright remains Eric Young's, and as such any Copyright notices in\n * the code are not to be removed.\n * If this package is used in a product, Eric Young should be given attribution\n * as the author of the parts of the library used.\n * This can be in the form of a textual message at program startup or\n * in documentation (online or textual) provided with the package.\n * \n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n * 1. Redistributions of source code must retain the copyright\n *    notice, this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright\n *    notice, this list of conditions and the following disclaimer in the\n *    documentation and/or other materials provided with the distribution.\n * 3. All advertising materials mentioning features or use of this software\n *    must display the following acknowledgement:\n *    \\\"This product includes cryptographic software written by\n *     Eric Young (eay@cryptsoft.com)\\\"\n *    The word 'cryptographic' can be left out if the rouines from the library\n *    being used are not cryptographic related :-).\n * 4. If you include any Windows specific code (or a derivative thereof) from \n *    the apps directory (application code) you must include an acknowledgement:\n *    \\\"This product includes software written by Tim Hudson (tjh@cryptsoft.com)\\\"\n * \n * THIS SOFTWARE IS PROVIDED BY ERIC YOUNG ``AS IS'\\' AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE\n * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS\n * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY\n * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\n * SUCH DAMAGE.\n * \n * The licence and distribution terms for any publically available version or\n * derivative of this code cannot be changed.  i.e. this code cannot simply be\n * copied and put under another distribution licence\n * [including the GNU Public Licence.]\n */")),MTChild (TChild (TKind "include") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "include")]),MTChild (TChild (TKind "file") [MText (TText "&lt;limits.h&gt;")])]),MTChild (TChild (TKind "include") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "include")]),MTChild (TChild (TKind "file") [MText (TText "&lt;string.h&gt;")])]),MTChild (TChild (TKind "include") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "include")]),MTChild (TChild (TKind "file") [MText (TText "&lt;stdio.h&gt;")])]),MTChild (TChild (TKind "include") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "include")]),MTChild (TChild (TKind "file") [MText (TText "\\\"ssl_locl.h\\\"")])]),MTChild (TChild (TKind "include") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "include")]),MTChild (TChild (TKind "file") [MText (TText "&lt;openssl/buffer.h&gt;")])]),MTChild (TChild (TKind "include") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "include")]),MTChild (TChild (TKind "file") [MText (TText "&lt;openssl/rand.h&gt;")])]),MTChild (TChild (TKind "include") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "include")]),MTChild (TChild (TKind "file") [MText (TText "&lt;openssl/objects.h&gt;")])]),MTChild (TChild (TKind "include") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "include")]),MTChild (TChild (TKind "file") [MText (TText "&lt;openssl/evp.h&gt;")])]),MTChild (TChild (TKind "include") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "include")]),MTChild (TChild (TKind "file") [MText (TText "&lt;openssl/x509.h&gt;")])]),MTChild (TChild (TKind "define") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "define")]),MTChild (TChild (TKind "macro") [MTChild (TChild (TKind "name") [MText (TText "RSMBLY_BITMASK_SIZE")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "msg_len")])])]),MText (TText ")")])]),MTChild (TChild (TKind "value") [MText (TText "(((msg_len) + 7) / 8)")])]),MTChild (TChild (TKind "define") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "define")]),MTChild (TChild (TKind "macro") [MTChild (TChild (TKind "name") [MText (TText "RSMBLY_BITMASK_MARK")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "bitmask")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "start")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "end")])])]),MText (TText ")")])]),MTChild (TChild (TKind "value") [MText (TText "{ \\\\\n                        if ((end) - (start) &lt;= 8) { \\\\\n                                long ii; \\\\\n                                for (ii = (start); ii &lt; (end); ii++) bitmask[((ii) &gt;&gt; 3)] |= (1 &lt;&lt; ((ii) &amp; 7)); \\\\\n                        } else { \\\\\n                                long ii; \\\\\n                                bitmask[((start) &gt;&gt; 3)] |= bitmask_start_values[((start) &amp; 7)]; \\\\\n                                for (ii = (((start) &gt;&gt; 3) + 1); ii &lt; ((((end) - 1)) &gt;&gt; 3); ii++) bitmask[ii] = 0xff; \\\\\n                                bitmask[(((end) - 1) &gt;&gt; 3)] |= bitmask_end_values[((end) &amp; 7)]; \\\\\n                        } }")])]),MTChild (TChild (TKind "define") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "define")]),MTChild (TChild (TKind "macro") [MTChild (TChild (TKind "name") [MText (TText "RSMBLY_BITMASK_IS_COMPLETE")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "bitmask")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "msg_len")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "is_complete")])])]),MText (TText ")")])]),MTChild (TChild (TKind "value") [MText (TText "{ \\\\\n                        long ii; \\\\\n                        OPENSSL_assert((msg_len) &gt; 0); \\\\\n                        is_complete = 1; \\\\\n                        if (bitmask[(((msg_len) - 1) &gt;&gt; 3)] != bitmask_end_values[((msg_len) &amp; 7)]) is_complete = 0; \\\\\n                        if (is_complete) for (ii = (((msg_len) - 1) &gt;&gt; 3) - 1; ii &gt;= 0 ; ii--) \\\\\n                                if (bitmask[ii] != 0xff) { is_complete = 0; break; } }")])]),MTChild (TChild (TKind "if") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "if")]),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MTChild (TChild (TKind "define") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "define")]),MTChild (TChild (TKind "macro") [MTChild (TChild (TKind "name") [MText (TText "RSMBLY_BITMASK_PRINT")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "bitmask")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "msg_len")])])]),MText (TText ")")])]),MTChild (TChild (TKind "value") [MText (TText "{ \\\\\n                        long ii; \\\\\n                        printf(\\\"bitmask: \\\"); for (ii = 0; ii &lt; (msg_len); ii++) \\\\\n                        printf(\\\"%d \\\", (bitmask[ii &gt;&gt; 3] &amp; (1 &lt;&lt; (ii &amp; 7))) &gt;&gt; (ii &amp; 7)); \\\\\n                        printf(\\\"\\\\n\\\"); }")])]),MTChild (TChild (TKind "endif") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "endif")])]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "specifier") [MText (TText "static")]),MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")])]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "bitmask_start_values")]),MTChild (TChild (TKind "index") [MText (TText "[]")])]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0xff"))]),MText (TText ","),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0xfe"))]),MText (TText ","),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0xfc"))]),MText (TText ","),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0xf8"))]),MText (TText ","),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0xf0"))]),MText (TText ","),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0xe0"))]),MText (TText ","),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0xc0"))]),MText (TText ","),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0x80"))]),MText (TText "}")])])])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "specifier") [MText (TText "static")]),MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")])]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "bitmask_end_values")]),MTChild (TChild (TKind "index") [MText (TText "[]")])]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0xff"))]),MText (TText ","),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0x01"))]),MText (TText ","),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0x03"))]),MText (TText ","),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0x07"))]),MText (TText ","),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0x0f"))]),MText (TText ","),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0x1f"))]),MText (TText ","),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0x3f"))]),MText (TText ","),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0x7f"))]),MText (TText "}")])])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* XDTLS:  figure out the right values */")),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "specifier") [MText (TText "static")]),MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "g_probable_mtu")]),MTChild (TChild (TKind "index") [MText (TText "[]")])]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1500")),MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "28"))]),MText (TText ","),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "512")),MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "28"))]),MText (TText ","),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "256")),MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "28"))]),MText (TText "}")])])])]),MText (TText ";")]),MTChild (TChild (TKind "function_decl") [MTChild (TChild (TKind "specifier") [MText (TText "static")]),MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_guess_mtu")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "curr_mtu")])])]),MText (TText ")")]),MText (TText ";")]),MTChild (TChild (TKind "function_decl") [MTChild (TChild (TKind "specifier") [MText (TText "static")]),MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "void")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_fix_message_header")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])])]),MText (TText ")")]),MText (TText ";")]),MTChild (TChild (TKind "function_decl") [MTChild (TChild (TKind "specifier") [MText (TText "static")]),MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_write_message_header")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ")")]),MText (TText ";")]),MTChild (TChild (TKind "function_decl") [MTChild (TChild (TKind "specifier") [MText (TText "static")]),MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "void")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_set_message_header_int")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")])]),MTChild (TChild (TKind "name") [MText (TText "mt")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "len")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "short")])]),MTChild (TChild (TKind "name") [MText (TText "seq_num")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])])]),MText (TText ")")]),MText (TText ";")]),MTChild (TChild (TKind "function_decl") [MTChild (TChild (TKind "specifier") [MText (TText "static")]),MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_get_message_fragment")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "st1")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "stn")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "max")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "ok")])])]),MText (TText ")")]),MText (TText ";")]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "specifier") [MText (TText "static")]),MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "hm_fragment")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_hm_fragment_new")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "reassembly")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "hm_fragment")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "NULL")])])])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "buf")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "NULL")])])])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "bitmask")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "NULL")])])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "hm_fragment")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_malloc")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "hm_fragment")])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ";")])])])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "buf")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_malloc")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "buf")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_free")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ";")]),MText (TText "}")])])]),MText (TText "}")])])]),MTChild (TCommentChild (TCommentText "/* zero length fragment gets zero frag-&gt;fragment */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "fragment")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "buf")])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* Initialize reassembly bitmask if necessary */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "reassembly")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "bitmask")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_malloc")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "RSMBLY_BITMASK_SIZE")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "bitmask")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "buf")]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_free")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "buf")])])]),MText (TText ")")])])]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_free")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memset")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "bitmask")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "RSMBLY_BITMASK_SIZE")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "reassembly")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "bitmask")])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "specifier") [MText (TText "static")]),MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "void")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_hm_fragment_free")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "hm_fragment")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "frag")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "is_ccs")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "EVP_CIPHER_CTX_free")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "saved_retransmit_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "enc_write_ctx")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "EVP_MD_CTX_destroy")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "saved_retransmit_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "write_hash")])])])]),MText (TText ")")])])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "fragment")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_free")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "fragment")])])])]),MText (TText ")")])])]),MText (TText ";")])])])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "reassembly")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_free")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "reassembly")])])])]),MText (TText ")")])])]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_free")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")])])]),MText (TText ")")])])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TCommentChild (TCommentText "/* send s-&gt;init_buf in records of type 'type' (SSL3_RT_HANDSHAKE or SSL3_RT_CHANGE_CIPHER_SPEC) */")),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_do_write")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "type")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "ret")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "curr_mtu")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "len")])]),MText (TText ","),MTChild (TChild (TKind "decl") [MTChild (TSingleKindChild (TKind "type")),MTChild (TChild (TKind "name") [MText (TText "frag_off")])]),MText (TText ","),MTChild (TChild (TKind "decl") [MTChild (TSingleKindChild (TKind "type")),MTChild (TChild (TKind "name") [MText (TText "mac_size")])]),MText (TText ","),MTChild (TChild (TKind "decl") [MTChild (TSingleKindChild (TKind "type")),MTChild (TChild (TKind "name") [MText (TText "blocksize")])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* AHA!  Figure out the MTU, and stick to the right size */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "mtu")])]),MTChild (TChild (TKind "operator") [MText (TText "&lt;")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_min_mtu")]),MTChild (TChild (TKind "argument_list") [MText (TText "()")])]),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "operator") [MText (TText "!")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSL_get_options")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])]),MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MText (TText "SSL_OP_NO_QUERY_MTU")]),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "mtu")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "BIO_ctrl")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSL_get_wbio")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "BIO_CTRL_DGRAM_QUERY_MTU")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "NULL")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* I've seen the kernel return bogus numbers when it doesn't know\n                 * (initial write), so just make sure we have a reasonable number */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "mtu")])]),MTChild (TChild (TKind "operator") [MText (TText "&lt;")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_min_mtu")]),MTChild (TChild (TKind "argument_list") [MText (TText "()")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "mtu")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "mtu")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_guess_mtu")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "mtu")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "BIO_ctrl")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSL_get_wbio")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "BIO_CTRL_DGRAM_SET_MTU")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "mtu")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "NULL")])])]),MText (TText ")")])])]),MText (TText ";")]),MText (TText "}")])])]),MText (TText "}")])])]),MTChild (TChild (TKind "if") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "if")]),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText "mtu = s-&gt;d1-&gt;mtu;\n\n        fprintf(stderr, \\\"using MTU = %d\\\\n\\\", mtu);\n\n        mtu -= (DTLS1_HM_HEADER_LENGTH + DTLS1_RT_HEADER_LENGTH);\n\n        curr_mtu = mtu - BIO_wpending(SSL_get_wbio(s));\n\n        if ( curr_mtu &gt; 0)\n                mtu = curr_mtu;\n        else if ( ( ret = BIO_flush(SSL_get_wbio(s))) &lt;= 0)\n                return ret;\n\n        if ( BIO_wpending(SSL_get_wbio(s)) + s-&gt;init_num &gt;= mtu)\n                {\n                ret = BIO_flush(SSL_get_wbio(s));\n                if ( ret &lt;= 0)\n                        return ret;\n                mtu = s-&gt;d1-&gt;mtu - (DTLS1_HM_HEADER_LENGTH + DTLS1_RT_HEADER_LENGTH);\n                }"),MTChild (TChild (TKind "endif") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "endif")])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_assert")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "mtu")])]),MTChild (TChild (TKind "operator") [MText (TText "&gt;=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_min_mtu")]),MTChild (TChild (TKind "argument_list") [MText (TText "()")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* should have something reasonable now */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_off")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0")),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "name") [MText (TText "type")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "SSL3_RT_HANDSHAKE")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_assert")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "int")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "w_msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])])]),MText (TText ")")])])]),MText (TText ";")])])])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "write_hash")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "mac_size")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "EVP_MD_CTX_size")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "write_hash")])])])]),MText (TText ")")])])]),MText (TText ";")])])]),MTChild (TChild (TKind "else") [MText (TText "else"),MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "mac_size")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")])])])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "enc_write_ctx")])]),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "EVP_CIPHER_mode")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "enc_write_ctx")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "cipher")])])])]),MText (TText ")")])]),MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MText (TText "EVP_CIPH_CBC_MODE")]),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "blocksize")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "2")),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "EVP_CIPHER_block_size")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "enc_write_ctx")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "cipher")])])])]),MText (TText ")")])])]),MText (TText ";")])])]),MTChild (TChild (TKind "else") [MText (TText "else"),MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "blocksize")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_off")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "while") [MText (TText "while"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "curr_mtu")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "mtu")])]),MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "BIO_wpending")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSL_get_wbio")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])])])]),MText (TText ")")])]),MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_RT_HEADER_LENGTH")]),MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TChild (TKind "name") [MText (TText "mac_size")]),MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TChild (TKind "name") [MText (TText "blocksize")])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "curr_mtu")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;=")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TCommentChild (TCommentText "/* grr.. we could get an error if MTU picked was wrong */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ret")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "BIO_flush")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSL_get_wbio")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ret")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ret")])]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "curr_mtu")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "mtu")])]),MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_RT_HEADER_LENGTH")]),MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TChild (TKind "name") [MText (TText "mac_size")]),MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TChild (TKind "name") [MText (TText "blocksize")])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])]),MTChild (TChild (TKind "operator") [MText (TText "&gt;")]),MTChild (TChild (TKind "name") [MText (TText "curr_mtu")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "len")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "curr_mtu")])]),MText (TText ";")])])]),MTChild (TChild (TKind "else") [MText (TText "else"),MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "len")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])])]),MText (TText ";")])])])]),MTChild (TCommentChild (TCommentText "/* XDTLS: this function is too long.  split out the CCS part */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "type")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "SSL3_RT_HANDSHAKE")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_off")])]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_assert")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_off")])]),MTChild (TChild (TKind "operator") [MText (TText "&gt;")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_off")])]),MTChild (TChild (TKind "operator") [MText (TText "-=")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])]),MTChild (TChild (TKind "operator") [MText (TText "+=")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])]),MTChild (TChild (TKind "operator") [MText (TText "&gt;")]),MTChild (TChild (TKind "name") [MText (TText "curr_mtu")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "len")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "curr_mtu")])]),MText (TText ";")])])]),MTChild (TChild (TKind "else") [MText (TText "else"),MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "len")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])])]),MText (TText ";")])])])]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_fix_message_header")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_off")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "len")]),MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_write_message_header")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_buf")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_off")])])]),MText (TText "]")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_assert")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "len")]),MTChild (TChild (TKind "operator") [MText (TText "&gt;=")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])])]),MText (TText ")")])])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ret")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_write_bytes")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "type")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_buf")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_off")])])]),MText (TText "]")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "len")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ret")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TCommentChild (TCommentText "/* might need to update MTU here, but we don't know\n                         * which previous packet caused the failure -- so can't\n                         * really retransmit anything.  continue as if everything\n                         * is fine and wait for an alert to handle the\n                         * retransmit \n                         */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "BIO_ctrl")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSL_get_wbio")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "BIO_CTRL_DGRAM_MTU_EXCEEDED")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "NULL")])])]),MText (TText ")")])]),MTChild (TChild (TKind "operator") [MText (TText "&gt;")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "mtu")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "BIO_ctrl")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSL_get_wbio")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "BIO_CTRL_DGRAM_QUERY_MTU")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "NULL")])])]),MText (TText ")")])])]),MText (TText ";")])])]),MTChild (TChild (TKind "else") [MText (TText "else"),MTChild (TBlockChild [MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1")),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ";")])])])]),MText (TText "}")])]),MTChild (TChild (TKind "else") [MText (TText "else"),MTChild (TBlockChild [MText (TText "{"),MTChild (TCommentChild (TCommentText "/* bad if this assert fails, only part of the handshake\n                         * message got sent.  but why would this happen? */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_assert")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "len")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "int")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MText (TText "ret")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "type")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "SSL3_RT_HANDSHAKE")]),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "operator") [MText (TText "!")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "retransmitting")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TCommentChild (TCommentText "/* should not be done for 'Hello Request's, but in that case\n                                 * we'll ignore the result anyway */")),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_buf")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_off")])])]),MText (TText "]")])])])])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "specifier") [MText (TText "const")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "struct")]),MTChild (TChild (TKind "name") [MText (TText "hm_header_st")])]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "w_msg_hdr")])])])])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "xlen")])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_off")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0")),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "version")])]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_BAD_VER")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TCommentChild (TCommentText "/* reconstruct message header is if it\n                                         * is being sent in single fragment */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "operator") [MText (TText "++")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "type")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "l2n3")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "s2n")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "seq")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "l2n3")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "l2n3")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "operator") [MText (TText "-=")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "xlen")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "ret")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "else") [MText (TText "else"),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "operator") [MText (TText "+=")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "xlen")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "ret")]),MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "ssl3_finish_mac")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "xlen")])])]),MText (TText ")")])])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ret")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_callback")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_callback")])]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "version")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "type")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_buf")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MText (TText "("),MTChild (TChild (TKind "name") [MText (TText "size_t")]),MText (TText ")"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_off")])]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])])])]),MText (TText ")")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_callback_arg")])])])]),MText (TText ")")])])]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_off")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* done writing this message */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1")),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_off")])]),MTChild (TChild (TKind "operator") [MText (TText "+=")]),MTChild (TChild (TKind "name") [MText (TText "ret")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])]),MTChild (TChild (TKind "operator") [MText (TText "-=")]),MTChild (TChild (TKind "name") [MText (TText "ret")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_off")]),MTChild (TChild (TKind "operator") [MText (TText "+=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "ret")]),MTChild (TChild (TKind "operator") [MText (TText "-=")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")]),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ";")]),MText (TText "}")])])]),MText (TText "}")])]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0")),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TCommentChild (TCommentText "/* Obtain handshake message of message type 'mt' (any if mt == -1),\n * maximum acceptable body length 'max'.\n * Read an entire handshake message.  Handshake messages arrive in\n * fragments.\n */")),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_get_message")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "st1")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "stn")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "mt")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "max")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "ok")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "i")])]),MText (TText ","),MTChild (TChild (TKind "decl") [MTChild (TSingleKindChild (TKind "type")),MTChild (TChild (TKind "name") [MText (TText "al")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "struct")]),MTChild (TChild (TKind "name") [MText (TText "hm_header_st")])]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "msg_hdr")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "p")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* s3-&gt;tmp is used to store messages that are unexpected, caused\n         * by the absence of an optional handshake message */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "tmp")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "reuse_message")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "tmp")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "reuse_message")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "mt")]),MTChild (TChild (TKind "operator") [MText (TText "&gt;=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0")),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "tmp")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "message_type")])]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TChild (TKind "name") [MText (TText "mt")]),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "al")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "SSL_AD_UNEXPECTED_MESSAGE")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSLerr")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_F_DTLS1_GET_MESSAGE")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_R_UNEXPECTED_MESSAGE")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "goto") [MText (TText "goto"),MTChild (TChild (TKind "name") [MText (TText "f_err")]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "ok")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_msg")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_buf")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")])]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "int")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "tmp")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "message_size")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "r_msg_hdr")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memset")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0x00"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MText (TText "struct"),MTChild (TChild (TKind "name") [MText (TText "hm_header_st")])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "label") [MTChild (TChild (TKind "name") [MText (TText "again")]),MText (TText ":")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_get_message_fragment")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "st1")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "stn")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "max")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ok")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_BAD_FRAGMENT")]),MTChild (TChild (TKind "operator") [MText (TText "||")]),MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_FRAGMENT_RETRY")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TCommentChild (TCommentText "/* bad fragment received */")),MTChild (TBlockChild [MTChild (TChild (TKind "goto") [MText (TText "goto"),MTChild (TChild (TKind "name") [MText (TText "again")]),MText (TText ";")])])]),MTChild (TChild (TKind "elseif") [MText (TText "else"),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0")),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "operator") [MText (TText "!")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "ok")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")])]),MText (TText ";")])])])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_buf")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "msg_len")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* reconstruct message header */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "operator") [MText (TText "++")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "type")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "l2n3")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "msg_len")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "s2n")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "seq")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "l2n3")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "l2n3")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "msg_len")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "version")])]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_BAD_VER")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "operator") [MText (TText "-=")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "msg_len")]),MTChild (TChild (TKind "operator") [MText (TText "+=")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "ssl3_finish_mac")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "msg_len")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_callback")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_callback")])]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "version")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL3_RT_HANDSHAKE")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "msg_len")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_callback_arg")])])])]),MText (TText ")")])])]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memset")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0x00"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MText (TText "struct"),MTChild (TChild (TKind "name") [MText (TText "hm_header_st")])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* Don't change sequence numbers while listening */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "!")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "listen")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "handshake_read_seq")])]),MTChild (TChild (TKind "operator") [MText (TText "++")])]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_msg")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_buf")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")])]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])])]),MText (TText ";")]),MTChild (TChild (TKind "label") [MTChild (TChild (TKind "name") [MText (TText "f_err")]),MText (TText ":")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "ssl3_send_alert")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL3_AL_FATAL")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "al")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "ok")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "specifier") [MText (TText "static")]),MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_preprocess_fragment")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "struct")]),MTChild (TChild (TKind "name") [MText (TText "hm_header_st")])]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "msg_hdr")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "max")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "size_t")])]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])]),MText (TText ","),MTChild (TChild (TKind "decl") [MTChild (TSingleKindChild (TKind "type")),MTChild (TChild (TKind "name") [MText (TText "frag_len")])]),MText (TText ","),MTChild (TChild (TKind "decl") [MTChild (TSingleKindChild (TKind "type")),MTChild (TChild (TKind "name") [MText (TText "msg_len")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "msg_len")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_off")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* sanity checking */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "operator") [MText (TText "&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSLerr")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_F_DTLS1_PREPROCESS_FRAGMENT")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_R_EXCESSIVE_MESSAGE_SIZE")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_AD_ILLEGAL_PARAMETER")])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "operator") [MText (TText "&gt;")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MText (TText "max")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSLerr")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_F_DTLS1_PREPROCESS_FRAGMENT")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_R_EXCESSIVE_MESSAGE_SIZE")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_AD_ILLEGAL_PARAMETER")])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "r_msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TCommentChild (TCommentText "/* first fragment */")),MTChild (TBlockChild [MText (TText "{"),MTChild (TCommentChild (TCommentText "/* msg_len is limited to 2^24, but is effectively checked\n                 * against max above */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "!")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "BUF_MEM_grow_clean")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_buf")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "msg_len")]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])])]),MText (TText ")")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSLerr")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_F_DTLS1_PREPROCESS_FRAGMENT")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ERR_R_BUF_LIB")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_AD_INTERNAL_ERROR")])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "tmp")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "message_size")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "r_msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "tmp")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "message_type")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "type")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "r_msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "type")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "type")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "r_msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "seq")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "seq")])])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "elseif") [MText (TText "else"),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "msg_len")]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "r_msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TCommentChild (TCommentText "/* They must be playing with us! BTW, failure to enforce\n                 * upper limit would open possibility for buffer overrun. */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSLerr")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_F_DTLS1_PREPROCESS_FRAGMENT")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_R_EXCESSIVE_MESSAGE_SIZE")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_AD_ILLEGAL_PARAMETER")])]),MText (TText ";")]),MText (TText "}")])])])])]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* no error */")),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "specifier") [MText (TText "static")]),MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_retrieve_buffered_fragment")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "max")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "ok")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TCommentChild (TCommentText "/* (0) check whether the desired fragment is available\n         * if so:\n         * (1) copy over the fragment to s-&gt;init_buf-&gt;data[]\n         * (2) update s-&gt;init_num\n         */")),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "pitem")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "item")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "hm_fragment")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "frag")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "al")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "ok")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "pqueue_peek")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "buffered_messages")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "hm_fragment")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* Don't return if reassembly still in progress */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "reassembly")])]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")])])])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "handshake_read_seq")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "seq")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])])])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "pqueue_pop")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "buffered_messages")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "al")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_preprocess_fragment")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "max")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "al")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TCommentChild (TCommentText "/* no alert */")),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_buf")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")])]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memcpy")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])])]),MText (TText "]")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "fragment")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])])])]),MText (TText ")")])])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_hm_fragment_free")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "pitem_free")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "al")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "ok")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "ssl3_send_alert")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL3_AL_FATAL")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "al")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "ok")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "else") [MText (TText "else"),MTChild (TBlockChild [MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")])])])]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "specifier") [MText (TText "static")]),MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_reassemble_fragment")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "struct")]),MTChild (TChild (TKind "name") [MText (TText "hm_header_st")])]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "msg_hdr")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "ok")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "hm_fragment")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "NULL")])])])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "pitem")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "NULL")])])])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))])])]),MText (TText ","),MTChild (TChild (TKind "decl") [MTChild (TSingleKindChild (TKind "type")),MTChild (TChild (TKind "name") [MText (TText "is_complete")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")])]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "seq64be")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "8"))]),MText (TText "]")])])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])])])])]),MText (TText ","),MTChild (TChild (TKind "decl") [MTChild (TSingleKindChild (TKind "type")),MTChild (TChild (TKind "name") [MText (TText "max_len")])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "operator") [MText (TText "&gt;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "goto") [MText (TText "goto"),MTChild (TChild (TKind "name") [MText (TText "err")]),MText (TText ";")])])])]),MTChild (TCommentChild (TCommentText "/* Determine maximum allowed message size. Depends on (user set)\n         * maximum certificate length, but 16k is minimum.\n         */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "SSL3_RT_MAX_ENCRYPTED_LENGTH")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "max_cert_list")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "max_len")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "max_cert_list")])])]),MText (TText ";")])])]),MTChild (TChild (TKind "else") [MText (TText "else"),MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "max_len")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "SSL3_RT_MAX_ENCRYPTED_LENGTH")])]),MText (TText ";")])])])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "operator") [MText (TText "&gt;")]),MTChild (TChild (TKind "name") [MText (TText "max_len")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "goto") [MText (TText "goto"),MTChild (TChild (TKind "name") [MText (TText "err")]),MText (TText ";")])])])]),MTChild (TCommentChild (TCommentText "/* Try to find item in queue */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memset")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq64be")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq64be")])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "seq64be")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "6"))]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MText (TText "("),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MText (TText ")"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "seq")])]),MTChild (TChild (TKind "operator") [MText (TText "&gt;&gt;")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "8"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "seq64be")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "7"))]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "seq")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "pqueue_find")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "buffered_messages")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq64be")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_hm_fragment_new")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "goto") [MText (TText "goto"),MTChild (TChild (TKind "name") [MText (TText "err")]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memcpy")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")])]),MTChild (TChild (TKind "operator") [MText (TText ")")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "msg_hdr")])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "else") [MText (TText "else"),MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "hm_fragment")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")])])]),MText (TText ";")])])])]),MTChild (TCommentChild (TCommentText "/* If message is already reassembled, this must be a\n         * retransmit and can be dropped.\n         */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "reassembly")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")])]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "devnull")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "256"))]),MText (TText "]")])])]),MText (TText ";")]),MTChild (TChild (TKind "while") [MText (TText "while"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "method")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "ssl_read_bytes")])]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL3_RT_HANDSHAKE")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "devnull")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "ternary") [MTChild (TChild (TKind "condition") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "operator") [MText (TText "&gt;")]),MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "devnull")])])]),MText (TText ")")])])]),MText (TText "?")]),MTChild (TChild (TKind "then") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "devnull")])])]),MText (TText ")")])])])]),MTChild (TChild (TKind "else") [MText (TText ":"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")])])])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "goto") [MText (TText "goto"),MTChild (TChild (TKind "name") [MText (TText "err")]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "operator") [MText (TText "-=")]),MTChild (TChild (TKind "name") [MText (TText "i")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_FRAGMENT_RETRY")])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TCommentChild (TCommentText "/* read the body of the fragment (header has already been read */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "method")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "ssl_read_bytes")])]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL3_RT_HANDSHAKE")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "fragment")])]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0")),MTChild (TChild (TKind "operator") [MText (TText "||")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "goto") [MText (TText "goto"),MTChild (TChild (TKind "name") [MText (TText "err")]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "RSMBLY_BITMASK_MARK")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "reassembly")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "long")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MText (TText "("),MTChild (TChild (TKind "name") [MText (TText "long")]),MText (TText ")"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "RSMBLY_BITMASK_IS_COMPLETE")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "reassembly")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "long")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "is_complete")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "is_complete")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_free")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "reassembly")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "reassembly")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memset")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq64be")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq64be")])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "seq64be")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "6"))]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MText (TText "("),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MText (TText ")"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "seq")])]),MTChild (TChild (TKind "operator") [MText (TText "&gt;&gt;")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "8"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "seq64be")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "7"))]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MText (TText "("),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MText (TText ")"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "seq")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "pitem_new")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq64be")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "goto") [MText (TText "goto"),MTChild (TChild (TKind "name") [MText (TText "err")]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "pqueue_insert")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "buffered_messages")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")])])]),MText (TText ")")])])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_FRAGMENT_RETRY")])]),MText (TText ";")]),MTChild (TChild (TKind "label") [MTChild (TChild (TKind "name") [MText (TText "err")]),MText (TText ":")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_hm_fragment_free")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")])])]),MText (TText ")")])])]),MText (TText ";")])])])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_free")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")])])]),MText (TText ")")])])]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "ok")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "specifier") [MText (TText "static")]),MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_process_out_of_seq_message")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "struct")]),MTChild (TChild (TKind "name") [MText (TText "hm_header_st")])]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "msg_hdr")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "ok")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))])])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "hm_fragment")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "NULL")])])])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "pitem")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "NULL")])])])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")])]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "seq64be")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "8"))]),MText (TText "]")])])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])])])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "operator") [MText (TText "&gt;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "goto") [MText (TText "goto"),MTChild (TChild (TKind "name") [MText (TText "err")]),MText (TText ";")])])])]),MTChild (TCommentChild (TCommentText "/* Try to find item in queue, to prevent duplicate entries */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memset")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq64be")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq64be")])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "seq64be")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "6"))]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MText (TText "("),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MText (TText ")"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "seq")])]),MTChild (TChild (TKind "operator") [MText (TText "&gt;&gt;")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "8"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "seq64be")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "7"))]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "seq")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "pqueue_find")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "buffered_messages")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq64be")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* If we already have an entry and this one is a fragment,\n         * don't discard it and rather try to reassemble it.\n         */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TChild (TKind "name") [MText (TText "NULL")]),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ";")])])])]),MTChild (TCommentChild (TCommentText "/* Discard the message if sequence number was already there, is\n         * too far in the future, already in the queue or if we received\n         * a FINISHED before the SERVER_HELLO, which then must be a stale\n         * retransmit.\n         */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "seq")])]),MTChild (TChild (TKind "operator") [MText (TText "&lt;=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "handshake_read_seq")])]),MTChild (TChild (TKind "operator") [MText (TText "||")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "seq")])]),MTChild (TChild (TKind "operator") [MText (TText "&gt;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "handshake_read_seq")])]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "10")),MTChild (TChild (TKind "operator") [MText (TText "||")]),MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TChild (TKind "name") [MText (TText "NULL")]),MTChild (TChild (TKind "operator") [MText (TText "||")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "handshake_read_seq")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0")),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "type")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "SSL3_MT_FINISHED")]),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")])]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "devnull")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "256"))]),MText (TText "]")])])]),MText (TText ";")]),MTChild (TChild (TKind "while") [MText (TText "while"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "method")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "ssl_read_bytes")])]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL3_RT_HANDSHAKE")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "devnull")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "ternary") [MTChild (TChild (TKind "condition") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "operator") [MText (TText "&gt;")]),MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "devnull")])])]),MText (TText ")")])])]),MText (TText "?")]),MTChild (TChild (TKind "then") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "devnull")])])]),MText (TText ")")])])])]),MTChild (TChild (TKind "else") [MText (TText ":"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")])])])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "goto") [MText (TText "goto"),MTChild (TChild (TKind "name") [MText (TText "err")]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "operator") [MText (TText "-=")]),MTChild (TChild (TKind "name") [MText (TText "i")])]),MText (TText ";")]),MText (TText "}")])]),MText (TText "}")])]),MTChild (TChild (TKind "else") [MText (TText "else"),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_reassemble_fragment")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ok")])])]),MText (TText ")")])])]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_hm_fragment_new")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "goto") [MText (TText "goto"),MTChild (TChild (TKind "name") [MText (TText "err")]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memcpy")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")])]),MTChild (TChild (TKind "operator") [MText (TText ")")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "msg_hdr")])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TCommentChild (TCommentText "/* read the body of the fragment (header has already been read */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "method")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "ssl_read_bytes")])]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL3_RT_HANDSHAKE")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "fragment")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0")),MTChild (TChild (TKind "operator") [MText (TText "||")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "goto") [MText (TText "goto"),MTChild (TChild (TKind "name") [MText (TText "err")]),MText (TText ";")])])])]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memset")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq64be")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq64be")])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "seq64be")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "6"))]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MText (TText "("),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MText (TText ")"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "seq")])]),MTChild (TChild (TKind "operator") [MText (TText "&gt;&gt;")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "8"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "seq64be")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "7"))]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MText (TText "("),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MText (TText ")"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "seq")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "pitem_new")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq64be")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "goto") [MText (TText "goto"),MTChild (TChild (TKind "name") [MText (TText "err")]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "pqueue_insert")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "buffered_messages")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")])])]),MText (TText ")")])])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_FRAGMENT_RETRY")])]),MText (TText ";")]),MTChild (TChild (TKind "label") [MTChild (TChild (TKind "name") [MText (TText "err")]),MText (TText ":")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_hm_fragment_free")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")])])]),MText (TText ")")])])]),MText (TText ";")])])])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_free")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")])])]),MText (TText ")")])])]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "ok")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "specifier") [MText (TText "static")]),MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_get_message_fragment")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "st1")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "stn")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "max")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "ok")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")])]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "wire")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])]),MText (TText "]")])])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "len")])]),MText (TText ","),MTChild (TChild (TKind "decl") [MTChild (TSingleKindChild (TKind "type")),MTChild (TChild (TKind "name") [MText (TText "frag_off")])]),MText (TText ","),MTChild (TChild (TKind "decl") [MTChild (TSingleKindChild (TKind "type")),MTChild (TChild (TKind "name") [MText (TText "frag_len")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "i")])]),MText (TText ","),MTChild (TChild (TKind "decl") [MTChild (TSingleKindChild (TKind "type")),MTChild (TChild (TKind "name") [MText (TText "al")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "struct")]),MTChild (TChild (TKind "name") [MText (TText "hm_header_st")])])]),MTChild (TChild (TKind "name") [MText (TText "msg_hdr")])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* see if we have the required fragment already */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_retrieve_buffered_fragment")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "max")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ok")])])]),MText (TText ")")])]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "operator") [MText (TText "||")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "ok")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "ok")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])]),MText (TText ";")])])])]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TCommentChild (TCommentText "/* read handshake message header */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "method")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "ssl_read_bytes")])]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL3_RT_HANDSHAKE")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "wire")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TCommentChild (TCommentText "/* nbio, or an error */")),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "rwstate")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "SSL_READING")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "ok")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TCommentChild (TCommentText "/* Handshake fails if message header is incomplete */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "al")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "SSL_AD_UNEXPECTED_MESSAGE")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSLerr")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_F_DTLS1_GET_MESSAGE_FRAGMENT")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_R_UNEXPECTED_MESSAGE")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "goto") [MText (TText "goto"),MTChild (TChild (TKind "name") [MText (TText "f_err")]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TCommentChild (TCommentText "/* parse the message fragment header */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_get_message_header")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "wire")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MText (TText "msg_hdr")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* \n         * if this is a future (or stale) message it gets buffered\n         * (or dropped)--no further processing at this time\n         * While listening, we accept seq 1 (ClientHello with cookie)\n         * although we're still expecting seq 0 (ClientHello)\n         */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "seq")])]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "handshake_read_seq")])]),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "operator") [MText (TText "!")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "listen")])]),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "seq")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1")),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_process_out_of_seq_message")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MText (TText "msg_hdr")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ok")])])]),MText (TText ")")])])]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "len")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_off")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;")]),MTChild (TChild (TKind "name") [MText (TText "len")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_reassemble_fragment")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MText (TText "msg_hdr")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ok")])])]),MText (TText ")")])])]),MText (TText ";")])])])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "!")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "server")])]),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "r_msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0")),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "wire")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "SSL3_MT_HELLO_REQUEST")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TCommentChild (TCommentText "/* The server may always send 'Hello Request' messages --\n                 * we are doing a handshake anyway now, so ignore them\n                 * if their format is correct. Does not count for\n                 * 'Finished' MAC. */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "wire")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0")),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "wire")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "2"))]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0")),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "wire")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "3"))]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_callback")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_callback")])]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "version")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL3_RT_HANDSHAKE")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "wire")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_callback_arg")])])])]),MText (TText ")")])])]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_get_message_fragment")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "st1")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "stn")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "max")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ok")])])]),MText (TText ")")])])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "else") [MText (TText "else"),MTChild (TCommentChild (TCommentText "/* Incorrectly formated Hello request */")),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "al")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "SSL_AD_UNEXPECTED_MESSAGE")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSLerr")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_F_DTLS1_GET_MESSAGE_FRAGMENT")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_R_UNEXPECTED_MESSAGE")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "goto") [MText (TText "goto"),MTChild (TChild (TKind "name") [MText (TText "f_err")]),MText (TText ";")]),MText (TText "}")])])]),MText (TText "}")])])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "al")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_preprocess_fragment")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MText (TText "msg_hdr")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "max")])])]),MText (TText ")")])]),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "goto") [MText (TText "goto"),MTChild (TChild (TKind "name") [MText (TText "f_err")]),MText (TText ";")])])])]),MTChild (TCommentChild (TCommentText "/* XDTLS:  ressurect this when restart is in place */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "state")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "stn")])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")]),MTChild (TChild (TKind "operator") [MText (TText "&gt;")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_buf")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")])]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "method")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "ssl_read_bytes")])]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL3_RT_HANDSHAKE")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_off")])]),MText (TText "]")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* XDTLS:  fix this--message fragments cannot span multiple packets */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "rwstate")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "SSL_READING")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "ok")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")])]),MText (TText ";")]),MText (TText "}")])])]),MText (TText "}")])]),MTChild (TChild (TKind "else") [MText (TText "else"),MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")])])])]),MTChild (TCommentChild (TCommentText "/* XDTLS:  an incorrectly formatted fragment should cause the \n         * handshake to fail */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "int")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "al")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "SSL3_AD_ILLEGAL_PARAMETER")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSLerr")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_F_DTLS1_GET_MESSAGE_FRAGMENT")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL3_AD_ILLEGAL_PARAMETER")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "goto") [MText (TText "goto"),MTChild (TChild (TKind "name") [MText (TText "f_err")]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "ok")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* Note that s-&gt;init_num is *not* used as current offset in\n         * s-&gt;init_buf-&gt;data, but as a counter summing up fragments'\n         * lengths: as soon as they sum up to handshake packet\n         * length, we assume we have got all the fragments. */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")])]),MText (TText ";")]),MTChild (TChild (TKind "label") [MTChild (TChild (TKind "name") [MText (TText "f_err")]),MText (TText ":")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "ssl3_send_alert")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL3_AL_FATAL")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "al")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "ok")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1")),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_send_finished")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "a")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "b")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "specifier") [MText (TText "const")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "sender")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "slen")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "p")])]),MText (TText ","),MTChild (TChild (TKind "modifier") [MText (TText "*")]),MTChild (TChild (TKind "decl") [MTChild (TSingleKindChild (TKind "type")),MTChild (TChild (TKind "name") [MText (TText "d")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "i")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "l")])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "state")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "a")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "d")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_buf")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "d")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "method")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "ssl3_enc")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "final_finish_mac")])]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "sender")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "slen")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "tmp")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "finish_md")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "tmp")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "finish_md_len")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "i")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memcpy")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "tmp")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "finish_md")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "operator") [MText (TText "+=")]),MTChild (TChild (TKind "name") [MText (TText "i")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "l")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "i")])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* Copy the finished so we can use it for\n         * renegotiation checks\n         */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "type")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "SSL_ST_CONNECT")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_assert")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;=")]),MTChild (TChild (TKind "name") [MText (TText "EVP_MAX_MD_SIZE")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memcpy")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "previous_client_finished")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "tmp")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "finish_md")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "previous_client_finished_len")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "i")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "else") [MText (TText "else"),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_assert")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;=")]),MTChild (TChild (TKind "name") [MText (TText "EVP_MAX_MD_SIZE")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memcpy")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "previous_server_finished")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "tmp")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "finish_md")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "previous_server_finished_len")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "i")])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "ifdef") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "ifdef")]),MTChild (TChild (TKind "name") [MText (TText "OPENSSL_SYS_WIN16")])]),MTChild (TCommentChild (TCommentText "/* MSVC 1.5 does not clear the top bytes of the word unless\n                 * I do this.\n                 */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "l")]),MTChild (TChild (TKind "operator") [MText (TText "&amp;=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0xffff"))]),MText (TText ";")]),MTChild (TChild (TKind "endif") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "endif")])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "d")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_set_message_header")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "d")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL3_MT_FINISHED")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "l")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "l")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "int")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MText (TText "l")]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_off")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* buffer the message to handle re-xmits */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_buffer_message")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "state")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "b")])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TCommentChild (TCommentText "/* SSL3_ST_SEND_xxxxxx_HELLO_B */")),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_do_write")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL3_RT_HANDSHAKE")])])]),MText (TText ")")])]),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TCommentChild (TCommentText "/* for these 2 messages, we need to\n * ssl-&gt;enc_read_ctx                    re-init\n * ssl-&gt;s3-&gt;read_sequence               zero\n * ssl-&gt;s3-&gt;read_mac_secret             re-init\n * ssl-&gt;session-&gt;read_sym_enc           assign\n * ssl-&gt;session-&gt;read_compression       assign\n * ssl-&gt;session-&gt;read_hash              assign\n */")),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_send_change_cipher_spec")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "a")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "b")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "p")])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "state")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "a")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_buf")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "operator") [MText (TText "++")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "SSL3_MT_CCS")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "handshake_write_seq")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "next_handshake_write_seq")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_CCS_HEADER_LENGTH")])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "version")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_BAD_VER")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "next_handshake_write_seq")])]),MTChild (TChild (TKind "operator") [MText (TText "++")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "s2n")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "handshake_write_seq")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])]),MTChild (TChild (TKind "operator") [MText (TText "+=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "2"))]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_off")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_set_message_header_int")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL3_MT_CCS")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "handshake_write_seq")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* buffer the message to handle re-xmits */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_buffer_message")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "state")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "b")])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TCommentChild (TCommentText "/* SSL3_ST_CW_CHANGE_B */")),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_do_write")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL3_RT_CHANGE_CIPHER_SPEC")])])]),MText (TText ")")])]),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "specifier") [MText (TText "static")]),MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_add_cert_to_buf")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "BUF_MEM")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "buf")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "l")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "X509")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "x")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "n")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "p")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "n")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "i2d_X509")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "x")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "NULL")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "!")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "BUF_MEM_grow_clean")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "buf")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MText (TText "("),MTChild (TChild (TKind "name") [MText (TText "int")]),MText (TText ")"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "n")]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "l")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "3"))])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSLerr")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_F_DTLS1_ADD_CERT_TO_BUF")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ERR_R_BUF_LIB")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "buf")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "l")])]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "l2n3")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "n")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "i2d_X509")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "x")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "l")]),MTChild (TChild (TKind "operator") [MText (TText "+=")]),MTChild (TChild (TKind "name") [MText (TText "n")]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "3"))]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_output_cert_chain")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "X509")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "x")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "p")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "i")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "l")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "3")),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])])])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "BUF_MEM")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "buf")])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* TLSv1 sends a chain with nothing in it, instead of an alert */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "buf")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_buf")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "!")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "BUF_MEM_grow_clean")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "buf")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "10"))])]),MText (TText ")")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSLerr")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_F_DTLS1_OUTPUT_CERT_CHAIN")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ERR_R_BUF_LIB")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0")),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "x")]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "X509_STORE_CTX")])]),MTChild (TChild (TKind "name") [MText (TText "xs_ctx")])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "!")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "X509_STORE_CTX_init")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MText (TText "xs_ctx")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "ctx")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "cert_store")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "x")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "NULL")])])]),MText (TText ")")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSLerr")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_F_DTLS1_OUTPUT_CERT_CHAIN")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ERR_R_X509_LIB")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0")),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "X509_verify_cert")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MText (TText "xs_ctx")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* Don't leave errors in the queue */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "ERR_clear_error")]),MTChild (TChild (TKind "argument_list") [MText (TText "()")])])]),MText (TText ";")]),MTChild (TChild (TKind "for") [MText (TText "for"),MTChild (TChild (TKind "control") [MText (TText "("),MTChild (TChild (TKind "init") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "condition") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "sk_X509_num")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "xs_ctx")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "chain")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "incr") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "++")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "x")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "sk_X509_value")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "xs_ctx")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "chain")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "!")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_add_cert_to_buf")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "buf")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MText (TText "l")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "x")])])]),MText (TText ")")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "X509_STORE_CTX_cleanup")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MText (TText "xs_ctx")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MText (TText "}")])])]),MText (TText "}")])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "X509_STORE_CTX_cleanup")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MText (TText "xs_ctx")])])]),MText (TText ")")])])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TCommentChild (TCommentText "/* Thawte special :-) */")),MTChild (TChild (TKind "for") [MText (TText "for"),MTChild (TChild (TKind "control") [MText (TText "("),MTChild (TChild (TKind "init") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "condition") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "sk_X509_num")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "ctx")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "extra_certs")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "incr") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "++")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "x")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "sk_X509_value")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "ctx")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "extra_certs")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "!")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_add_cert_to_buf")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "buf")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MText (TText "l")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "x")])])]),MText (TText ")")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")])])])]),MText (TText "}")])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "l")]),MTChild (TChild (TKind "operator") [MText (TText "-=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "3")),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")]),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "buf")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "l2n3")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "l")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "l")]),MTChild (TChild (TKind "operator") [MText (TText "+=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "3"))]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "buf")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_set_message_header")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL3_MT_CERTIFICATE")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "l")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "l")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "l")]),MTChild (TChild (TKind "operator") [MText (TText "+=")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "l")]),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_read_failed")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "code")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "code")]),MTChild (TChild (TKind "operator") [MText (TText "&gt;")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "fprintf")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "stderr")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "string") (TLiteralText "\\\"invalid state reached %s:%d\\\""))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "__FILE__")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "__LINE__")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "!")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_is_timer_expired")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TCommentChild (TCommentText "/* not a timeout, none of our business, \n                   let higher layers handle this.  in fact it's probably an error */")),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "code")])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "ifndef") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "ifndef")]),MTChild (TChild (TKind "name") [MText (TText "OPENSSL_NO_HEARTBEATS")])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "!")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSL_in_init")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])]),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "operator") [MText (TText "!")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "tlsext_hb_pending")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TCommentChild (TCommentText "/* done, no need to send a retransmit */")),MTChild (TChild (TKind "else") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "else")])]),MTChild (TBlockChild [MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "!")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSL_in_init")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TCommentChild (TCommentText "/* done, no need to send a retransmit */")),MTChild (TChild (TKind "endif") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "endif")])]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "BIO_set_flags")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSL_get_rbio")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "BIO_FLAGS_READ")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "code")])]),MText (TText ";")]),MText (TText "}")])])])])])]),MTChild (TChild (TKind "if") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "if")]),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MTChild (TCommentChild (TCommentText "/* for now, each alert contains only one record number */")),MText (TText "item = pqueue_peek(state-&gt;rcvd_records);\n        if ( item )\n                {"),MTChild (TCommentChild (TCommentText "/* send an alert immediately for all the missing records */")),MText (TText "}\n        else"),MTChild (TChild (TKind "endif") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "endif")])]),MTChild (TChild (TKind "if") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "if")]),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MTChild (TCommentChild (TCommentText "/* no more alert sending, just retransmit the last set of messages */")),MText (TText "if ( state-&gt;timeout.read_timeouts &gt;= DTLS1_TMO_READ_COUNT)\n                ssl3_send_alert(s,SSL3_AL_WARNING,\n                        DTLS1_AD_MISSING_HANDSHAKE_MESSAGE);"),MTChild (TChild (TKind "endif") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "endif")])]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_handle_timeout")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_get_queue_priority")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "short")])]),MTChild (TChild (TKind "name") [MText (TText "seq")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "is_ccs")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TCommentChild (TCommentText "/* The index of the retransmission queue actually is the message sequence number,\n         * since the queue only contains messages of a single handshake. However, the\n         * ChangeCipherSpec has no message sequence number and so using only the sequence\n         * will result in the CCS and Finished having the same index. To prevent this,\n         * the sequence number is multiplied by 2. In case of a CCS 1 is subtracted.\n         * This does not only differ CSS and Finished, it also maintains the order of the\n         * index (important for priority queues) and fits in the unsigned short variable.\n         */")),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "2")),MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TChild (TKind "name") [MText (TText "is_ccs")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_retransmit_buffered_messages")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "pqueue")])]),MTChild (TChild (TKind "name") [MText (TText "sent")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "sent_messages")])])])])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "piterator")])]),MTChild (TChild (TKind "name") [MText (TText "iter")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "pitem")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "item")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "hm_fragment")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "frag")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "found")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "iter")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "pqueue_iterator")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "sent")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "for") [MText (TText "for"),MTChild (TChild (TKind "control") [MText (TText "("),MTChild (TChild (TKind "init") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "pqueue_next")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MText (TText "iter")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "condition") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ";")]),MTChild (TChild (TKind "incr") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "pqueue_next")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MText (TText "iter")])])]),MText (TText ")")])])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "hm_fragment")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_retransmit_message")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "short")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_get_queue_priority")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "seq")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "is_ccs")])])])]),MText (TText ")")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MText (TText "found")])])]),MText (TText ")")])]),MTChild (TChild (TKind "operator") [MText (TText "&lt;=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0")),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "name") [MText (TText "found")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "fprintf")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "stderr")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "string") (TLiteralText "\\\"dtls1_retransmit_message() failed\\n\\\""))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText ";")]),MText (TText "}")])])]),MText (TText "}")])]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_buffer_message")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "is_ccs")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "pitem")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "item")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "hm_fragment")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "frag")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")])]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "seq64be")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "8"))]),MText (TText "]")])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* this function is called immediately after a message has \n         * been serialized */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_assert")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_off")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_hm_fragment_new")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memcpy")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "fragment")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_buf")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "is_ccs")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_assert")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "w_msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "ternary") [MTChild (TChild (TKind "condition") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "version")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_VERSION")]),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText "?")]),MTChild (TChild (TKind "then") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "DTLS1_CCS_HEADER_LENGTH")])])]),MTChild (TChild (TKind "else") [MText (TText ":"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "3"))])])]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "int")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])])])]),MText (TText ")")])])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "else") [MText (TText "else"),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_assert")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "w_msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "int")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])])])]),MText (TText ")")])])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "w_msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "seq")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "w_msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "seq")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "type")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "w_msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "type")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "w_msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "is_ccs")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "is_ccs")])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* save current state*/")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "saved_retransmit_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "enc_write_ctx")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "enc_write_ctx")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "saved_retransmit_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "write_hash")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "write_hash")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "saved_retransmit_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "compress")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "compress")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "saved_retransmit_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "session")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "session")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "saved_retransmit_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "epoch")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "w_epoch")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memset")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq64be")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq64be")])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "seq64be")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "6"))]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MText (TText "("),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MText (TText ")"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_get_queue_priority")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "seq")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "is_ccs")])])])]),MText (TText ")")])]),MTChild (TChild (TKind "operator") [MText (TText "&gt;&gt;")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "8"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "seq64be")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "7"))]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MText (TText "("),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MText (TText ")"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_get_queue_priority")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "seq")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "is_ccs")])])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "pitem_new")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq64be")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_hm_fragment_free")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "if") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "if")]),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText "fprintf( stderr, \\\"buffered messge: \\\\ttype = %xx\\\\n\\\", msg_buf-&gt;type);\n        fprintf( stderr, \\\"\\\\t\\\\t\\\\t\\\\t\\\\tlen = %d\\\\n\\\", msg_buf-&gt;len);\n        fprintf( stderr, \\\"\\\\t\\\\t\\\\t\\\\t\\\\tseq_num = %d\\\\n\\\", msg_buf-&gt;seq_num);"),MTChild (TChild (TKind "endif") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "endif")])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "pqueue_insert")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "sent_messages")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_retransmit_message")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "short")])]),MTChild (TChild (TKind "name") [MText (TText "seq")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "found")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "ret")])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* XDTLS: for now assuming that read/writes are blocking */")),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "pitem")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "item")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "hm_fragment")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "frag")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "header_length")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")])]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "seq64be")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "8"))]),MText (TText "]")])])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "struct")]),MTChild (TChild (TKind "name") [MText (TText "dtls1_retransmit_state")])])]),MTChild (TChild (TKind "name") [MText (TText "saved_state")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")])]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "save_write_sequence")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "8"))]),MText (TText "]")])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/*\n          OPENSSL_assert(s-&gt;init_num == 0);\n          OPENSSL_assert(s-&gt;init_off == 0);\n         */")),MTChild (TCommentChild (TCommentText "/* XDTLS:  the requested message ought to be found, otherwise error */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memset")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq64be")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq64be")])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "seq64be")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "6"))]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MText (TText "("),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MText (TText ")"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq")]),MTChild (TChild (TKind "operator") [MText (TText "&gt;&gt;")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "8"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "seq64be")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "7"))]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MText (TText "seq")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "pqueue_find")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "sent_messages")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq64be")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "fprintf")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "stderr")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "string") (TLiteralText "\\\"retransmit:  message %d non-existant\\n\\\""))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "found")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "found")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "hm_fragment")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "is_ccs")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "header_length")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_CCS_HEADER_LENGTH")])]),MText (TText ";")])])]),MTChild (TChild (TKind "else") [MText (TText "else"),MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "header_length")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memcpy")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_buf")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "fragment")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "header_length")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "init_num")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "header_length")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_set_message_header_int")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "type")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "seq")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* save current state */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "saved_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "enc_write_ctx")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "enc_write_ctx")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "saved_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "write_hash")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "write_hash")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "saved_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "compress")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "compress")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "saved_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "session")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "session")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "saved_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "epoch")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "w_epoch")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "saved_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "epoch")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "w_epoch")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "retransmitting")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* restore state in which the message was originally sent */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "enc_write_ctx")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "saved_retransmit_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "enc_write_ctx")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "write_hash")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "saved_retransmit_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "write_hash")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "compress")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "saved_retransmit_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "compress")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "session")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "saved_retransmit_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "session")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "w_epoch")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "saved_retransmit_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "epoch")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "saved_retransmit_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "epoch")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "saved_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "epoch")])]),MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memcpy")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "save_write_sequence")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "write_sequence")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "write_sequence")])])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memcpy")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "write_sequence")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "last_write_sequence")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "write_sequence")])])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ret")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_do_write")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "ternary") [MTChild (TChild (TKind "condition") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "is_ccs")])])]),MText (TText "?")]),MTChild (TChild (TKind "then") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL3_RT_CHANGE_CIPHER_SPEC")])])]),MTChild (TChild (TKind "else") [MText (TText ":"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL3_RT_HANDSHAKE")])])])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* restore current state */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "enc_write_ctx")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "saved_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "enc_write_ctx")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "write_hash")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "saved_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "write_hash")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "compress")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "saved_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "compress")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "session")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "saved_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "session")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "w_epoch")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "saved_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "epoch")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "frag")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_header")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "saved_retransmit_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "epoch")])]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "saved_state")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "epoch")])]),MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memcpy")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "last_write_sequence")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "write_sequence")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "write_sequence")])])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memcpy")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "write_sequence")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "save_write_sequence")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "write_sequence")])])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "retransmitting")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "void")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "BIO_flush")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSL_get_wbio")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ret")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TCommentChild (TCommentText "/* call this function when the buffered messages are no longer needed */")),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "void")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_clear_record_buffer")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "pitem")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "item")])]),MText (TText ";")]),MTChild (TChild (TKind "for") [MText (TText "for"),MTChild (TChild (TKind "control") [MText (TText "("),MTChild (TChild (TKind "init") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "pqueue_pop")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "sent_messages")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "condition") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "!=")]),MTChild (TChild (TKind "name") [MText (TText "NULL")])]),MText (TText ";")]),MTChild (TChild (TKind "incr") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "pqueue_pop")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "sent_messages")])])])]),MText (TText ")")])])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_hm_fragment_free")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "hm_fragment")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "item")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "data")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "pitem_free")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "item")])])]),MText (TText ")")])])]),MText (TText ";")]),MText (TText "}")])]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_set_message_header")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")])]),MTChild (TChild (TKind "name") [MText (TText "mt")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "len")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TCommentChild (TCommentText "/* Don't change sequence numbers while listening */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_off")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0")),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "operator") [MText (TText "!")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "listen")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "handshake_write_seq")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "next_handshake_write_seq")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "next_handshake_write_seq")])]),MTChild (TChild (TKind "operator") [MText (TText "++")])]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_set_message_header_int")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "mt")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "len")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "handshake_write_seq")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_off")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "frag_len")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "operator") [MText (TText "+=")]),MTChild (TChild (TKind "name") [MText (TText "DTLS1_HM_HEADER_LENGTH")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TCommentChild (TCommentText "/* don't actually do the writing, wait till the MTU has been retrieved */")),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "specifier") [MText (TText "static")]),MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "void")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_set_message_header_int")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")])]),MTChild (TChild (TKind "name") [MText (TText "mt")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "len")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "short")])]),MTChild (TChild (TKind "name") [MText (TText "seq_num")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "struct")]),MTChild (TChild (TKind "name") [MText (TText "hm_header_st")])]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "w_msg_hdr")])])])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "type")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "mt")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "len")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "seq")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "seq_num")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "specifier") [MText (TText "static")]),MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "void")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_fix_message_header")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "long")])]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "struct")]),MTChild (TChild (TKind "name") [MText (TText "hm_header_st")])]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "w_msg_hdr")])])])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "specifier") [MText (TText "static")]),MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_write_message_header")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "struct")]),MTChild (TChild (TKind "name") [MText (TText "hm_header_st")])]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "d1")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "w_msg_hdr")])])])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "operator") [MText (TText "++")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "type")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "l2n3")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "s2n")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "seq")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "l2n3")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "l2n3")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_min_mtu")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "void")])])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "g_probable_mtu")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "g_probable_mtu")])])]),MText (TText ")")])]),MTChild (TChild (TKind "operator") [MText (TText "/")]),MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "g_probable_mtu")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText "]")])])])]),MText (TText ")")])]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText "]")])]),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "specifier") [MText (TText "static")]),MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_guess_mtu")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "curr_mtu")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "i")])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "curr_mtu")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "g_probable_mtu")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText "]")])])]),MText (TText ";")])])])]),MTChild (TChild (TKind "for") [MText (TText "for"),MTChild (TChild (TKind "control") [MText (TText "("),MTChild (TChild (TKind "init") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MTChild (TChild (TKind "condition") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;")]),MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "g_probable_mtu")])])]),MText (TText ")")])]),MTChild (TChild (TKind "operator") [MText (TText "/")]),MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "g_probable_mtu")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText "]")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "incr") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")]),MTChild (TChild (TKind "operator") [MText (TText "++")])])]),MText (TText ")")]),MTChild (TBlockChild [MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "curr_mtu")]),MTChild (TChild (TKind "operator") [MText (TText "&gt;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "g_probable_mtu")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")])]),MText (TText "]")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "g_probable_mtu")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "i")])]),MText (TText "]")])])]),MText (TText ";")])])])])])]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "curr_mtu")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "void")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_get_message_header")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "data")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "struct")]),MTChild (TChild (TKind "name") [MText (TText "hm_header_st")])]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "msg_hdr")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memset")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0x00"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MText (TText "struct"),MTChild (TChild (TKind "name") [MText (TText "hm_header_st")])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "type")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "data")]),MTChild (TChild (TKind "operator") [MText (TText "++")]),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "n2l3")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "data")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_len")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "n2s")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "data")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "seq")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "n2l3")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "data")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "frag_off")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "n2l3")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "data")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "msg_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "frag_len")])])])]),MText (TText ")")])])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "void")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_get_ccs_header")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "data")])])]),MText (TText ","),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "struct")]),MTChild (TChild (TKind "name") [MText (TText "ccs_header_st")])]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "ccs_hdr")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memset")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ccs_hdr")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0x00"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "sizeof") [MText (TText "sizeof"),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MText (TText "struct"),MTChild (TChild (TKind "name") [MText (TText "ccs_header_st")])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "ccs_hdr")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "type")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MText (TText "data")]),MTChild (TChild (TKind "operator") [MText (TText "++")]),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_shutdown")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "ret")])]),MText (TText ";")]),MTChild (TChild (TKind "ifndef") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "ifndef")]),MTChild (TChild (TKind "name") [MText (TText "OPENSSL_NO_SCTP")])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "BIO_dgram_is_sctp")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSL_get_wbio")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])])])]),MText (TText ")")])]),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "operator") [MText (TText "!")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "shutdown")])]),MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MText (TText "SSL_SENT_SHUTDOWN")]),MTChild (TChild (TKind "operator") [MText (TText ")")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ret")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "BIO_dgram_sctp_wait_for_dry")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSL_get_wbio")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ret")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText ";")])])])]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ret")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "BIO_ctrl")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSL_get_wbio")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "BIO_CTRL_DGRAM_SCTP_SAVE_SHUTDOWN")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "NULL")])])]),MText (TText ")")])])]),MText (TText ";")])])])]),MText (TText "}")])])]),MTChild (TChild (TKind "endif") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "endif")])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ret")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "ssl3_shutdown")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "ifndef") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "ifndef")]),MTChild (TChild (TKind "name") [MText (TText "OPENSSL_NO_SCTP")])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "BIO_ctrl")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSL_get_wbio")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "BIO_CTRL_DGRAM_SCTP_SAVE_SHUTDOWN")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "NULL")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "endif") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "endif")])]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ret")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "ifndef") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "ifndef")]),MTChild (TChild (TKind "name") [MText (TText "OPENSSL_NO_HEARTBEATS")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_process_heartbeat")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "rrec")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "data")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText "]")])])])])]),MText (TText ","),MTChild (TChild (TKind "modifier") [MText (TText "*")]),MTChild (TChild (TKind "decl") [MTChild (TSingleKindChild (TKind "type")),MTChild (TChild (TKind "name") [MText (TText "pl")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "short")])]),MTChild (TChild (TKind "name") [MText (TText "hbtype")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "payload")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "padding")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "16"))])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* Use minimum padding */")),MTChild (TCommentChild (TCommentText "")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "")]),MTChild (TChild (TKind "operator") [MText (TText "")]),MTChild (TChild (TKind "operator") [MText (TText "")]),MTChild (TChild (TKind "name") [MText (TText "")]),MTChild (TChild (TKind "operator") [MText (TText "")])]),MText (TText "")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "")]),MTChild (TChild (TKind "argument_list") [MText (TText ""),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "")])])]),MText (TText ""),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "")])])]),MText (TText "")])])]),MText (TText "")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "")]),MTChild (TChild (TKind "operator") [MText (TText "")]),MTChild (TChild (TKind "name") [MText (TText "")])]),MText (TText "")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_callback")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_callback")])]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "version")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "TLS1_RT_HEARTBEAT")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "rrec")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "data")]),MTChild (TChild (TKind "index") [MText (TText "["),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText "]")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "rrec")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "length")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_callback_arg")])])])]),MText (TText ")")])])]),MText (TText ";")])])])]),MTChild (TCommentChild (TCommentText "/* Read type and payload length first */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1")),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "2")),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "16")),MTChild (TChild (TKind "operator") [MText (TText "&gt;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "rrec")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "length")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")])])])]),MTChild (TCommentChild (TCommentText "/* silently discard */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "hbtype")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "operator") [MText (TText "++")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "n2s")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "payload")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1")),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "2")),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "payload")]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "16")),MTChild (TChild (TKind "operator") [MText (TText "&gt;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "s3")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "rrec")]),MTChild (TChild (TKind "operator") [MText (TText ".")]),MTChild (TChild (TKind "name") [MText (TText "length")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")])])])]),MTChild (TCommentChild (TCommentText "/* silently discard per RFC 6520 sec. 4 */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "pl")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "p")])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "hbtype")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "TLS1_HB_REQUEST")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "buffer")])]),MText (TText ","),MTChild (TChild (TKind "modifier") [MText (TText "*")]),MTChild (TChild (TKind "decl") [MTChild (TSingleKindChild (TKind "type")),MTChild (TChild (TKind "name") [MText (TText "bp")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "write_length")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1")),MTChild (TCommentChild (TCommentText "/* heartbeat type */")),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "2")),MTChild (TCommentChild (TCommentText "/* heartbeat length */")),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "payload")]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "padding")])])])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "r")])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "write_length")]),MTChild (TChild (TKind "operator") [MText (TText "&gt;")]),MTChild (TChild (TKind "name") [MText (TText "SSL3_RT_MAX_PLAIN_LENGTH")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")])])])]),MTChild (TCommentChild (TCommentText "/* Allocate memory for the response, size is 1 byte\n                 * message type, plus 2 bytes payload length, plus\n                 * payload, plus padding\n                 */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "")]),MTChild (TChild (TKind "operator") [MText (TText "")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "")]),MTChild (TChild (TKind "argument_list") [MText (TText ""),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "")),MTChild (TChild (TKind "operator") [MText (TText "")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "")),MTChild (TChild (TKind "operator") [MText (TText "")]),MTChild (TChild (TKind "name") [MText (TText "")]),MTChild (TChild (TKind "operator") [MText (TText "")]),MTChild (TChild (TKind "name") [MText (TText "")])])]),MText (TText "")])])]),MText (TText "")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "buffer")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_malloc")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "write_length")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "bp")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "buffer")])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* Enter response type, length and copy payload */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "bp")]),MTChild (TChild (TKind "operator") [MText (TText "++")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "TLS1_HB_RESPONSE")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "s2n")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "payload")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "bp")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "memcpy")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "bp")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "pl")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "payload")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "bp")]),MTChild (TChild (TKind "operator") [MText (TText "+=")]),MTChild (TChild (TKind "name") [MText (TText "payload")])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* Random padding */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "RAND_pseudo_bytes")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "bp")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "padding")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "r")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_write_bytes")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "TLS1_RT_HEARTBEAT")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "buffer")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "")),MTChild (TChild (TKind "operator") [MText (TText "")]),MTChild (TChild (TKind "name") [MText (TText "")]),MTChild (TChild (TKind "operator") [MText (TText "")]),MTChild (TChild (TKind "name") [MText (TText "")])])]),MText (TText ""),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "write_length")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "r")]),MTChild (TChild (TKind "operator") [MText (TText "&gt;=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0")),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_callback")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_callback")])]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "version")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "TLS1_RT_HEARTBEAT")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "buffer")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "")),MTChild (TChild (TKind "operator") [MText (TText "")]),MTChild (TChild (TKind "name") [MText (TText "")]),MTChild (TChild (TKind "operator") [MText (TText "")]),MTChild (TChild (TKind "name") [MText (TText "")])])]),MText (TText ""),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "write_length")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_callback_arg")])])])]),MText (TText ")")])])]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_free")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "buffer")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "r")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "r")])]),MText (TText ";")])])])]),MText (TText "}")])]),MTChild (TChild (TKind "elseif") [MText (TText "else"),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "hbtype")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MText (TText "TLS1_HB_RESPONSE")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "seq")])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* We only send sequence numbers (2 bytes unsigned int),\n                 * and 16 random bytes, so we just try to read the\n                 * sequence number */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "n2s")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "pl")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "seq")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "payload")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "18")),MTChild (TChild (TKind "operator") [MText (TText "&amp;&amp;")]),MTChild (TChild (TKind "name") [MText (TText "seq")]),MTChild (TChild (TKind "operator") [MText (TText "==")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "tlsext_hb_seq")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_stop_timer")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "tlsext_hb_seq")])]),MTChild (TChild (TKind "operator") [MText (TText "++")])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "tlsext_hb_pending")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MText (TText "}")])])]),MText (TText "}")])])])])]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "function") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "dtls1_heartbeat")]),MTChild (TChild (TKind "parameter_list") [MText (TText "("),MTChild (TChild (TKind "parameter") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "SSL")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")]),MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "char")]),MTChild (TChild (TKind "modifier") [MText (TText "*")])]),MTChild (TChild (TKind "name") [MText (TText "buf")])]),MText (TText ","),MTChild (TChild (TKind "modifier") [MText (TText "*")]),MTChild (TChild (TKind "decl") [MTChild (TSingleKindChild (TKind "type")),MTChild (TChild (TKind "name") [MText (TText "p")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "ret")])]),MText (TText ";")]),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "payload")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "18"))])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* Sequence number + random bytes */")),MTChild (TChild (TKind "decl_stmt") [MTChild (TChild (TKind "decl") [MTChild (TChild (TKind "type") [MTChild (TChild (TKind "name") [MText (TText "unsigned")]),MTChild (TChild (TKind "name") [MText (TText "int")])]),MTChild (TChild (TKind "name") [MText (TText "padding")]),MTChild (TChild (TKind "init") [MText (TText "="),MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "16"))])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* Use minimum padding */")),MTChild (TCommentChild (TCommentText "/* Only send if peer supports and accepts HB requests... */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "!")]),MTChild (TChild (TKind "operator") [MText (TText "(")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "tlsext_heartbeat")])]),MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MText (TText "SSL_TLSEXT_HB_ENABLED")]),MTChild (TChild (TKind "operator") [MText (TText ")")]),MTChild (TChild (TKind "operator") [MText (TText "||")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "tlsext_heartbeat")])]),MTChild (TChild (TKind "operator") [MText (TText "&amp;")]),MTChild (TChild (TKind "name") [MText (TText "SSL_TLSEXT_HB_DONT_SEND_REQUESTS")])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSLerr")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_F_DTLS1_HEARTBEAT")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_R_TLS_HEARTBEAT_PEER_DOESNT_ACCEPT")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TCommentChild (TCommentText "/* ...and there is none in flight yet... */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "tlsext_hb_pending")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSLerr")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_F_DTLS1_HEARTBEAT")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_R_TLS_HEARTBEAT_PENDING")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TCommentChild (TCommentText "/* ...and no handshake in progress. */")),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSL_in_init")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])]),MTChild (TChild (TKind "operator") [MText (TText "||")]),MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "in_handshake")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "SSLerr")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_F_DTLS1_HEARTBEAT")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "SSL_R_UNEXPECTED_MESSAGE")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "-")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TCommentChild (TCommentText "/* Check if padding is too long, payload and padding\n         * must not exceed 2^14 - 3 = 16381 bytes in total.\n         */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_assert")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "payload")]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "padding")]),MTChild (TChild (TKind "operator") [MText (TText "&lt;=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "16381"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* Create HeartBeat message, we just use a sequence number\n         * as payload to distuingish different messages and add\n         * some random stuff.\n         *  - Message Type, 1 byte\n         *  - Payload Length, 2 bytes (unsigned int)\n         *  - Payload, the sequence number (2 bytes uint)\n         *  - Payload, random bytes (16 bytes uint)\n         *  - Padding\n         */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "buf")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_malloc")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1")),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "2")),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "payload")]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "padding")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "buf")])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* Message Type */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "operator") [MText (TText "*")]),MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "operator") [MText (TText "++")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "name") [MText (TText "TLS1_HB_REQUEST")])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* Payload length (18 bytes here) */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "s2n")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "payload")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* Sequence number */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "s2n")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "tlsext_hb_seq")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* 16 random bytes */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "RAND_pseudo_bytes")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "16"))])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")]),MTChild (TChild (TKind "operator") [MText (TText "+=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "16"))]),MText (TText ";")]),MTChild (TCommentChild (TCommentText "/* Random padding */")),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "RAND_pseudo_bytes")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "p")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "padding")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ret")]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_write_bytes")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "TLS1_RT_HEARTBEAT")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "buf")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "3")),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "payload")]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "padding")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ret")]),MTChild (TChild (TKind "operator") [MText (TText "&gt;=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "0"))]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MText (TText "{"),MTChild (TChild (TKind "if") [MText (TText "if"),MTChild (TChild (TKind "condition") [MText (TText "("),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_callback")])])]),MText (TText ")")]),MTChild (TChild (TKind "then") [MTChild (TBlockChild [MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_callback")])]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "version")])])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "TLS1_RT_HEARTBEAT")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "buf")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "3")),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "payload")]),MTChild (TChild (TKind "operator") [MText (TText "+")]),MTChild (TChild (TKind "name") [MText (TText "padding")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ","),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "msg_callback_arg")])])])]),MText (TText ")")])])]),MText (TText ";")])])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "dtls1_start_timer")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "s")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MTChild (TChild (TKind "name") [MText (TText "s")]),MTChild (TChild (TKind "operator") [MText (TText "-&gt;")]),MTChild (TChild (TKind "name") [MText (TText "tlsext_hb_pending")])]),MTChild (TChild (TKind "operator") [MText (TText "=")]),MTChild (TLiteralChild (TLiteralType "number") (TLiteralText "1"))]),MText (TText ";")]),MText (TText "}")])])]),MTChild (TChild (TKind "expr_stmt") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "call") [MTChild (TChild (TKind "name") [MText (TText "OPENSSL_free")]),MTChild (TChild (TKind "argument_list") [MText (TText "("),MTChild (TChild (TKind "argument") [MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "buf")])])]),MText (TText ")")])])]),MText (TText ";")]),MTChild (TChild (TKind "return") [MText (TText "return"),MTChild (TChild (TKind "expr") [MTChild (TChild (TKind "name") [MText (TText "ret")])]),MText (TText ";")]),MText (TText "}")])]),MTChild (TChild (TKind "endif") [MText (TText "#"),MTChild (TChild (TKind "directive") [MText (TText "endif")])])]